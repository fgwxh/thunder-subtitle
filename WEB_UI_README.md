# 迅雷字幕 Web UI 使用说明

## 功能特性

### 📁 视频目录扫描
- 自动扫描指定目录下的视频文件
- 支持多种视频格式：mp4, mkv, avi, mov, wmv, flv, webm, m4v
- 文件名不区分大小写
- 显示文件名、大小、路径等信息

### 🔍 字幕搜索
- 通过关键词搜索迅雷字幕
- 显示搜索结果列表，包含评分、语言、格式等信息
- 支持单个下载字幕
- 可预览字幕信息
- 支持复制下载链接

### 📦 批量下载
- 自动为目录中的所有视频搜索字幕
- 自动选择评分最高的字幕进行下载
- 显示下载进度和状态
- 支持并发下载控制

### 📜 下载历史
- 记录所有下载历史
- 显示字幕名称、保存路径、下载时间
- 支持清空历史记录
- 支持导出历史记录为JSON文件

### ⚙️ 配置管理
- 目录设置：视频目录、字幕保存目录
- 搜索设置：最低评分、语言过滤
- 下载设置：超时时间、重试次数、并发数
- 配置自动保存和加载

## 快速开始

### 1. 安装依赖

```bash
uv sync
```

### 2. 启动 Web UI

```bash
uv run python scripts/run_web_ui.py
```

或者直接使用 streamlit：

```bash
uv run streamlit run src/thunder_subtitle_cli/web_ui.py
```

### 3. 访问界面

浏览器打开：http://localhost:8501

## 使用流程

### 方式一：手动搜索下载

1. 在侧边栏设置字幕保存目录
2. 点击「字幕搜索」标签页
3. 输入搜索关键词
4. 点击「搜索」按钮
5. 在搜索结果中选择字幕
6. 点击「下载」按钮

### 方式二：批量下载

1. 在侧边栏设置视频目录和字幕保存目录
2. 点击「视频目录扫描」标签页
3. 点击「扫描视频」按钮
4. 点击「批量下载」标签页
5. 点击「开始批量搜索」按钮
6. 等待自动搜索和下载完成

## 配置说明

### 目录设置
- **视频目录**：包含视频文件的目录路径，用于批量扫描
- **字幕保存目录**：字幕文件保存的目录路径

### 搜索设置
- **最低评分**：过滤低于此评分的字幕（0-10）
- **语言过滤**：指定字幕语言，留空表示不限制

### 下载设置
- **下载超时**：单个字幕下载的超时时间（秒）
- **重试次数**：下载失败时的重试次数
- **并发数**：批量下载时的并发下载数

## 技术架构

- **前端框架**：Streamlit
- **后端**：复用现有的 thunder_subtitle_cli 模块
- **异步处理**：使用 asyncio 处理网络请求
- **配置存储**：JSON 格式本地存储

## 注意事项

1. 确保网络连接正常，能够访问迅雷字幕 API
2. 视频目录和字幕保存目录需要有读写权限
3. 批量下载时建议合理设置并发数，避免网络过载
4. 配置文件（ui_config.json）会自动保存在项目根目录

## 故障排除

### 扫描不到视频文件
- 检查视频目录路径是否正确
- 确认视频文件格式是否支持
- 检查目录访问权限

### 搜索不到字幕
- 检查网络连接
- 尝试降低最低评分设置
- 检查搜索关键词是否准确

### 下载失败
- 检查字幕保存目录是否有写入权限
- 增加下载超时时间
- 增加重试次数
- 检查网络连接稳定性
